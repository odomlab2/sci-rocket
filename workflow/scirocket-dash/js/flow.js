"use strict";(self.webpackChunk_am5=self.webpackChunk_am5||[]).push([[1239],{7984:function(e,t,n){n.r(t),n.d(t,{Chord:function(){return re},ChordDirected:function(){return oe},ChordLink:function(){return ie},ChordLinkDirected:function(){return ae},ChordNodes:function(){return ee},ChordNonRibbon:function(){return le},DefaultTheme:function(){return u},Flow:function(){return f},FlowLink:function(){return ne},FlowNode:function(){return Z},FlowNodes:function(){return $},Sankey:function(){return Re},SankeyLink:function(){return he},SankeyNodes:function(){return ce}});var i=n(5125),s=n(3409),r=n(6245),a=n(2754),o=n(3783),l=n(5071);class u extends s.Q{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this.rule.bind(this);t("Flow").setAll({width:r.AQ,height:r.AQ,paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),t("FlowNodes").setAll({colors:a.U.new(this._root,{}),legendLabelText:"{name}",legendValueText:"{sumOutgoing.formatNumber('#.#')}"}),t("FlowNode").setAll({}),t("FlowNode",["unknown"]).setAll({draggable:!1,opacity:0}),t("RadialLabel",["flow","node"]).setAll({text:"{name}",populateText:!0}),t("FlowLink").setAll({fillStyle:"gradient",strokeStyle:"gradient"}),t("FlowLink",["source","unknown"]).setAll({}),t("FlowLink",["target","unknown"]).setAll({}),t("FlowNode").events.on("pointerover",(e=>{const t=e.target.dataItem;if(t){const e=t.get("outgoingLinks");e&&l.each(e,(e=>{const t=e.get("link");t.hover(),t.hideTooltip()}));const n=t.get("incomingLinks");n&&l.each(n,(e=>{const t=e.get("link");t.hover(),t.hideTooltip()}))}let n=t.get("slice")||t.get("rectangle");n&&n.get("tooltipText")&&n.showTooltip()})),t("FlowNode").events.on("pointerout",(e=>{const t=e.target.dataItem;if(t){const e=t.get("outgoingLinks");e&&l.each(e,(e=>{e.get("link").unhover()}));const n=t.get("incomingLinks");n&&l.each(n,(e=>{e.get("link").unhover()}))}})),t("Sankey").setAll({orientation:"horizontal",nodeAlign:"justify",linkTension:.5,nodePadding:10,nodeWidth:10}),t("RoundedRectangle",["sankey","node","shape"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),t("SankeyLink").setAll({controlPointDistance:.2}),t("FlowNode",["sankey"]).setAll({draggable:!0});{const n=t("Graphics",["sankey","link"]);n.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0,tooltipText:"{sourceId} - {targetId}: {value}"}),(0,o.v)(n,"fill",e,"grid")}t("Graphics",["sankey","link"]).states.create("hover",{fillOpacity:.5}),t("Label",["sankey","node"]).setAll({text:"{name}",populateText:!0}),t("Label",["sankey","horizontal"]).setAll({y:r.CI,centerY:r.CI,paddingLeft:15}),t("Label",["sankey","vertical"]).setAll({x:r.CI,centerX:r.CI,paddingTop:15}),t("Chord").setAll({radius:(0,r.aQ)(90),nodeWidth:10,padAngle:1,startAngle:0,sort:"descending"}),t("ChordDirected").setAll({linkHeadRadius:10}),t("ChordNodes").setAll({x:r.CI,y:r.CI}),t("FlowNode",["chord"]).setAll({draggable:!0}),t("ChordLink").setAll({sourceRadius:r.AQ,targetRadius:r.AQ,fillStyle:"solid",strokeStyle:"solid",tooltipText:"{sourceId} - {targetId}: {value}"}),t("Slice",["chord","node","shape"]).setAll({cornerRadius:0}),t("RadialLabel",["chord","node"]).setAll({radius:5,textType:"circular"}),t("ChordLinkDirected").setAll({headRadius:10});{const n=t("Graphics",["chord","link","shape"]);n.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0}),(0,o.v)(n,"fill",e,"grid"),(0,o.v)(n,"stroke",e,"grid")}t("Graphics",["chord","link","shape"]).states.create("hover",{fillOpacity:.5}),t("ChordNonRibbon").setAll({linkType:"curve"}),t("ChordLink",["basic"]).setAll({fillStyle:"none",strokeStyle:"source"}),t("Graphics",["chord","link","shape","basic"]).setAll({strokeOpacity:.4}),t("Graphics",["chord","link","shape","basic"]).states.create("hover",{strokeWidth:2,strokeOpacity:1})}}var c=n(3399),h=n(8777),d=n(1747),g=n(5040);class f extends c.F{constructor(){super(...arguments),Object.defineProperty(this,"linksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(h.W.new(this._root,{}))}),Object.defineProperty(this,"_nodesData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_linksData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_index",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_nodesDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_linksByIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._defaultThemes.push(u.new(this._root)),this.fields.push("disabled","sourceId","targetId"),this.nodes&&(this.nodes.flow=this),super._afterNew(),this.children.push(this.bulletsContainer)}processDataItem(e){super.processDataItem(e);const t=this.nodes;if(t){let n=!1,i=e.get("sourceId"),s=t.getDataItemById(i);s||(null==i&&(i="undefined"+this._index,this._index++,n=!0),t.data.push({id:i,unknown:n}),s=t.getDataItemById(i),n||s.set("name",i)),n=!1;let r=e.get("targetId"),a=t.getDataItemById(r);a||(null==r&&(r="undefined"+this._index,this._index++,n=!0),t.data.push({id:r,unknown:n}),a=t.getDataItemById(r),n||a.set("name",r)),s&&(e.set("source",s),t.addOutgoingLink(s,e)),a&&(e.set("target",a),t.addincomingLink(a,e)),e.set("link",this.makeLink(e));const o=this.nodes.dataItems.indexOf(s),l=this.nodes.dataItems.indexOf(a);this._linksByIndex[o+"_"+l]=e,s.get("unknown")&&(a&&s.set("fill",a.get("fill")),e.get("link").set("fillStyle","gradient")),a.get("unknown")&&(s&&a.set("fill",s.get("fill")),e.get("link").set("fillStyle","gradient")),this._updateLinkColor(e)}}_onDataClear(){this.nodes._userDataSet||(this.nodes.data.setAll([]),this.nodes._userDataSet=!1)}_prepareChildren(){super._prepareChildren();let e=1/0,t=-1/0,n=0;if(this._valuesDirty){this._nodesData=[];const i=this.nodes;i&&l.each(i.dataItems,(e=>{const t=e.get("d3SankeyNode");this._nodesData.push(t);const n=e.get("incomingLinks");let s=0,r=0;n&&l.each(n,(e=>{const t=e.get("value"),n=e.get("valueWorking");s+=t,r+=n})),e.set("sumIncoming",s),e.set("sumIncomingWorking",r);const a=e.get("outgoingLinks");let o=0,u=0;a&&l.each(a,(e=>{const t=e.get("value"),n=e.get("valueWorking");o+=t,u+=n})),e.set("sumOutgoing",o),e.set("sumOutgoingWorking",u),e.set("sum",s+o),e.set("sumWorking",r+u),i.updateLegendValue(e)})),this._linksData=[],l.each(this.dataItems,(i=>{let s=i.get("value");g.isNumber(s)&&(s<e&&(e=s),s>t&&(t=s),n+=s)})),l.each(this.dataItems,(e=>{let t=e.get("value");if(g.isNumber(t)){let t=e.get("valueWorking"),i=this.get("minSize",0);i>0&&t<i*n&&(t=i*n);let s={source:e.get("source").get("d3SankeyNode"),target:e.get("target").get("d3SankeyNode"),value:t};e.setRaw("d3SankeyLink",s),this._linksData.push(s),this.updateLegendValue(e)}})),this.setPrivateRaw("valueHigh",t),this.setPrivateRaw("valueLow",e),this.setPrivateRaw("valueSum",n)}}_updateLinkColor(e){const t=e.get("link"),n=t.get("fillStyle"),i=t.get("strokeStyle"),s=e.get("source"),r=e.get("target"),a=s.get("fill"),o=r.get("fill");switch(t.remove("fillGradient"),t.remove("strokeGradient"),n){case"solid":t._applyTemplates();break;case"source":t.set("fill",a);break;case"target":t.set("fill",o);break;case"gradient":let e=t._fillGradient;if(!e){e=d.o.new(this._root,{});const n={color:a};s.get("unknown")&&(n.opacity=0);const i={color:o};r.get("unknown")&&(i.opacity=0),e.set("stops",[n,i]),t._fillGradient=e}t.set("fillGradient",e);break;case"none":t.set("fill",void 0)}switch(i){case"solid":t._applyTemplates();break;case"source":t.set("stroke",a);break;case"target":t.set("stroke",o);case"gradient":let e=t._strokeGradient;if(!e){e=d.o.new(this._root,{});const n={color:a};s.get("unknown")&&(n.opacity=0);const i={color:o};r.get("unknown")&&(i.opacity=0),e.set("stops",[n,i]),t._strokeGradient=e}t.set("strokeGradient",e);break;case"none":t.remove("stroke")}}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("link");t&&(this.links.removeValue(t),t.dispose())}hideDataItem(e,t){const n=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,i.mG)(this,void 0,void 0,(function*(){const i=[n.hideDataItem.call(this,e,t)],s=this.states.create("hidden",{}),r="stateAnimationDuration",a="stateAnimationEasing";g.isNumber(t)||(t=s.get(r,this.get(r,0)));const o=s.get(a,this.get(a));i.push(e.animate({key:"valueWorking",to:0,duration:t,easing:o}).waitForStop()),e.get("link").hide(),yield Promise.all(i)}))}showDataItem(e,t){const n=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,i.mG)(this,void 0,void 0,(function*(){const i=[n.showDataItem.call(this,e,t)];g.isNumber(t)||(t=this.get("stateAnimationDuration",0));const s=this.get("stateAnimationEasing");i.push(e.animate({key:"valueWorking",to:e.get("value"),duration:t,easing:s}).waitForStop()),e.get("link").show(),yield Promise.all(i)}))}_positionBullet(e){const t=e.get("sprite");if(t){const n=t.dataItem;if(n){const t=n.get("link"),i=e.get("sprite");if(i){const n=t.getPoint(this._getBulletLocation(e));i.setAll({x:n.x,y:n.y}),e.get("autoRotate")&&i.set("rotation",n.angle+e.get("autoRotateAngle",0))}}}}_getBulletLocation(e){return e.get("locationY",0)}}Object.defineProperty(f,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Flow"}),Object.defineProperty(f,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:c.F.classNames.concat([f.className])});var p=Math.abs,b=Math.cos,m=Math.sin,y=Math.PI,k=y/2,w=2*y,v=Math.max,_=1e-12;function x(e,t){return Array.from({length:t-e},((t,n)=>e+n))}function A(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}function N(e,t){var n=0,i=null,s=null,r=null;function a(a){var o,l=a.length,u=new Array(l),c=x(0,l),h=new Array(l*l),d=new Array(l),g=0;a=Float64Array.from({length:l*l},t?(e,t)=>a[t%l][t/l|0]:(e,t)=>a[t/l|0][t%l]);for(let t=0;t<l;++t){let n=0;for(let i=0;i<l;++i)n+=a[t*l+i]+e*a[i*l+t];g+=u[t]=n}o=(g=v(0,w-n*l)/g)?n:w/l;{let t=0;i&&c.sort(((e,t)=>i(u[e],u[t])));for(const n of c){const i=t;if(e){const e=x(1+~l,l).filter((e=>e<0?a[~e*l+n]:a[n*l+e]));s&&e.sort(((e,t)=>s(e<0?-a[~e*l+n]:a[n*l+e],t<0?-a[~t*l+n]:a[n*l+t])));for(const i of e)i<0?(h[~i*l+n]||(h[~i*l+n]={source:null,target:null})).target={index:n,startAngle:t,endAngle:t+=a[~i*l+n]*g,value:a[~i*l+n]}:(h[n*l+i]||(h[n*l+i]={source:null,target:null})).source={index:n,startAngle:t,endAngle:t+=a[n*l+i]*g,value:a[n*l+i]};d[n]={index:n,startAngle:i,endAngle:t,value:u[n]}}else{const e=x(0,l).filter((e=>a[n*l+e]||a[e*l+n]));s&&e.sort(((e,t)=>s(a[n*l+e],a[n*l+t])));for(const i of e){let e;if(n<i?(e=h[n*l+i]||(h[n*l+i]={source:null,target:null}),e.source={index:n,startAngle:t,endAngle:t+=a[n*l+i]*g,value:a[n*l+i]}):(e=h[i*l+n]||(h[i*l+n]={source:null,target:null}),e.target={index:n,startAngle:t,endAngle:t+=a[n*l+i]*g,value:a[n*l+i]},n===i&&(e.source=e.target)),e.source&&e.target&&e.source.value<e.target.value){const t=e.source;e.source=e.target,e.target=t}}d[n]={index:n,startAngle:i,endAngle:t,value:u[n]}}t+=o}}return(h=Object.values(h)).groups=d,r?h.sort(r):h}return a.padAngle=function(e){return arguments.length?(n=v(0,e),a):n},a.sortGroups=function(e){return arguments.length?(i=e,a):i},a.sortSubgroups=function(e){return arguments.length?(s=e,a):s},a.sortChords=function(e){return arguments.length?(null==e?r=null:(r=A(e))._=e,a):r&&r._},a}var L=n(5493),P=Array.prototype.slice;function I(e){return function(){return e}}function D(e){return e.source}function O(e){return e.target}function T(e){return e.radius}function j(e){return e.startAngle}function S(e){return e.endAngle}function C(){return 0}function R(){return 10}function G(e){var t=D,n=O,i=T,s=T,r=j,a=S,o=C,l=null;function u(){var u,c=t.apply(this,arguments),h=n.apply(this,arguments),d=o.apply(this,arguments)/2,g=P.call(arguments),f=+i.apply(this,(g[0]=c,g)),y=r.apply(this,g)-k,w=a.apply(this,g)-k,v=+s.apply(this,(g[0]=h,g)),x=r.apply(this,g)-k,A=a.apply(this,g)-k;if(l||(l=u=(0,L.ET)()),d>_&&(p(w-y)>2*d+_?w>y?(y+=d,w-=d):(y-=d,w+=d):y=w=(y+w)/2,p(A-x)>2*d+_?A>x?(x+=d,A-=d):(x-=d,A+=d):x=A=(x+A)/2),l.moveTo(f*b(y),f*m(y)),l.arc(0,0,f,y,w),y!==x||w!==A)if(e){var N=+e.apply(this,arguments),I=v-N,D=(x+A)/2;l.quadraticCurveTo(0,0,I*b(x),I*m(x)),l.lineTo(v*b(D),v*m(D)),l.lineTo(I*b(A),I*m(A))}else l.quadraticCurveTo(0,0,v*b(x),v*m(x)),l.arc(0,0,v,x,A);if(l.quadraticCurveTo(0,0,f*b(y),f*m(y)),l.closePath(),u)return l=null,u+""||null}return e&&(u.headRadius=function(t){return arguments.length?(e="function"==typeof t?t:I(+t),u):e}),u.radius=function(e){return arguments.length?(i=s="function"==typeof e?e:I(+e),u):i},u.sourceRadius=function(e){return arguments.length?(i="function"==typeof e?e:I(+e),u):i},u.targetRadius=function(e){return arguments.length?(s="function"==typeof e?e:I(+e),u):s},u.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:I(+e),u):r},u.endAngle=function(e){return arguments.length?(a="function"==typeof e?e:I(+e),u):a},u.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:I(+e),u):o},u.source=function(e){return arguments.length?(t=e,u):t},u.target=function(e){return arguments.length?(n=e,u):n},u.context=function(e){return arguments.length?(l=null==e?null:e,u):l},u}function M(){return G()}function F(){return G(R)}function W(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function B(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}n(7896);const{abs:Y,max:E,min:z}=Math;function V(e){return{type:e}}function Q(e,t,n){this.k=e,this.x=t,this.y=n}["w","e"].map(V),["n","s"].map(V),["n","w","e","s","nw","ne","sw","se"].map(V),Q.prototype={constructor:Q,scale:function(e){return 1===e?this:new Q(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Q(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Q(1,0,0),Q.prototype;var X=n(5769),H=n(7144),q=n(962);class Z extends h.W{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}Object.defineProperty(Z,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNode"}),Object.defineProperty(Z,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:h.W.classNames.concat([Z.className])});class $ extends c.F{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>q._._new(this._root,{},[this.labels.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>Z._new(this._root,{themeTags:["node"]},[this.nodes.template])))}),Object.defineProperty(this,"_userDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.fields.push("unknown","name","fill"),this.set("idField","id"),this.set("nameField","id"),this.set("fillField","fill"),this.set("unknownField","unknown"),this.children.push(this.bulletsContainer),super._afterNew()}_onDataClear(){const e=this.get("colors");e&&e.reset(),this._userDataSet=!0}processDataItem(e){if(super.processDataItem(e),e.setRaw("d3SankeyNode",{name:e.get("id"),dataItem:e}),null==e.get("fill")){let t=this.get("colors");t&&e.setRaw("fill",t.next())}e.setRaw("node",this.makeNode(e))}makeNode(e,t){const n=this.nodes.make();return this.nodes.push(n),t&&n.addTag(t),e.get("unknown")&&n.addTag("unknown"),this.children.push(n),n._setDataItem(e),n.series=this,e.set("node",n),n}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("node");t&&(this.nodes.removeValue(t),t.dispose());let n=e.get("label");n&&(this.labels.removeValue(n),n.dispose())}addincomingLink(e,t){let n=e.get("incomingLinks");n||(n=[],e.set("incomingLinks",n)),n.push(t)}addOutgoingLink(e,t){let n=e.get("outgoingLinks");n||(n=[],e.set("outgoingLinks",n)),n.push(t)}showDataItem(e,t){const n=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,i.mG)(this,void 0,void 0,(function*(){const i=[n.showDataItem.call(this,e,t)],s=this.flow;if(s){let n=e.get("label");n&&n.show(t);let i=e.get("outgoingLinks");i&&l.each(i,(e=>{s.showDataItem(e,t)})),i=e.get("incomingLinks"),i&&l.each(i,(e=>{s.showDataItem(e,t)}))}yield i}))}hideDataItem(e,t){const n=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,i.mG)(this,void 0,void 0,(function*(){const i=[n.hideDataItem.call(this,e,t)],s=this.flow;if(s){let n=e.get("label");n&&n.hide(t);let i=e.get("outgoingLinks");i&&l.each(i,(e=>{s.hideDataItem(e,t)})),i=e.get("incomingLinks"),i&&l.each(i,(e=>{s.hideDataItem(e,t)}))}yield i}))}}Object.defineProperty($,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNodes"}),Object.defineProperty($,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:c.F.classNames.concat([$.className])});var K=n(5863),U=n(815),J=n(751);class ee extends ${constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>U.x._new(this._root,{},[this.labels.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>K.p._new(this._root,{themeTags:["shape"]},[this.rectangles.template])))})}makeNode(e){const t=super.makeNode(e,"chord"),n=t.children.insertIndex(0,this.rectangles.make());e.set("slice",n),n._setSoft("fill",e.get("fill"));const i=this.labels.make();return this.labels.push(i),i.addTag("flow"),i.addTag("chord"),i.addTag("node"),t.children.push(i),e.set("label",i),t.events.on("dragstart",(e=>{let t=this.toLocal(e.point);const n=J.getAngle({x:0,y:0},t);this.flow&&(this._dAngle=this.flow.get("startAngle",0)-n)})),t.events.on("dragged",(e=>{let n=this.toLocal(e.point);const i=J.getAngle({x:0,y:0},n);t.setAll({x:0,y:0}),this.flow&&this.flow.set("startAngle",i+this._dAngle)})),i._setDataItem(e),n._setDataItem(e),t}_positionBullet(e){const t=e.get("sprite");if(t){const n=t.dataItem;if(n){const t=e.get("sprite");if(t){const i=n.get("slice"),s=e.get("locationX",.5),r=e.get("locationY",.5);if(i){const e=i.get("radius",0),n=i.get("innerRadius",0),a=n+(e-n)*r,o=i.get("startAngle",0)+i.get("arc",0)*s;t.setAll({x:a*J.cos(o),y:a*J.sin(o)})}}}}}}Object.defineProperty(ee,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNodes"}),Object.defineProperty(ee,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:$.classNames.concat([ee.className])});var te=n(1479);class ne extends te.T{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_changed(){if(super._changed(),this.isDirty("fillStyle")){const e=this.series,t=this.dataItem;e&&t&&e._updateLinkColor(t)}}_getTooltipPoint(){let e=this.get("tooltipY"),t=.5;return e instanceof r.gG&&(t=e.value),this.getPoint(t)}}Object.defineProperty(ne,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowLink"}),Object.defineProperty(ne,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:te.T.classNames.concat([ne.className])});class ie extends ne{constructor(){super(...arguments),Object.defineProperty(this,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getPoint(e){if(this._p0&&this._p1){if("line"===this._type){let t=J.getPointOnLine(this._p0,this._p1,e);return{x:t.x,y:t.y,angle:J.getAngle(this._p0,this._p1)}}{let t=J.getPointOnQuadraticCurve(this._p0,this._p1,{x:0,y:0},Math.max(0,e-.01)),n=J.getPointOnQuadraticCurve(this._p0,this._p1,{x:0,y:0},Math.min(1,e+.01)),i=J.getPointOnQuadraticCurve(this._p0,this._p1,{x:0,y:0},e);return{x:i.x,y:i.y,angle:J.getAngle(t,n)}}}return{x:0,y:0,angle:0}}}Object.defineProperty(ie,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLink"}),Object.defineProperty(ie,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ne.classNames.concat([ie.className])});var se=n(7652);class re extends f{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>ie._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ee.new(this._root,{}))}),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:N(!1,!1)}),Object.defineProperty(this,"_chordLayout",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_ribbon",{enumerable:!0,configurable:!0,writable:!0,value:M()})}_afterNew(){this._settings.themeTags=se.mergeTags(this._settings.themeTags,["chord"]),this.linksContainer.setAll({x:r.CI,y:r.CI}),this.bulletsContainer.setAll({x:r.CI,y:r.CI}),super._afterNew()}_fixRibbon(e){e.startAngle((e=>e.startAngle+this.get("startAngle",0)*J.RADIANS+Math.PI/2)),e.endAngle((e=>e.endAngle+this.get("startAngle",0)*J.RADIANS+Math.PI/2))}makeLink(e){const t=this.linksContainer.children.push(this.links.make());return this.links.push(t),t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_makeMatrix(){const e=[];return l.each(this.nodes.dataItems,(t=>{const n=[];e.push(n);let i=t.get("outgoingLinks");l.each(this.nodes.dataItems,(e=>{let t=0;i&&l.each(i,(n=>{n.get("target")===e&&(t=n.get("valueWorking"));let i=this.getPrivate("valueSum",0),s=this.get("minSize",0);t>0&&s>0&&t<i*s&&(t=i*s)})),n.push(t)}))})),e}_prepareChildren(){super._prepareChildren(),this._fixRibbon(this._ribbon);let e=!1;if(this._valuesDirty||this._sizeDirty||this.isDirty("padAngle")||this.isDirty("startAngle")){const t=this._makeMatrix();this._d3chord.padAngle(this.get("padAngle",0)*J.RADIANS);const n=this.get("sort");"ascending"===n?this._d3chord.sortGroups(W):"descending"===n&&this._d3chord.sortGroups(B),this._chordLayout=this._d3chord(t),e=!0}if(e||this.isDirty("radius")||this.isDirty("nodeWidth")){let e=se.relativeToValue(this.get("radius",0),Math.min(this.innerWidth(),this.innerHeight()))/2,t=0;const n=this.get("startAngle",0),i=this.get("nodeWidth",0);l.each(this.nodes.dataItems,(s=>{const r=s.get("slice"),a=this._chordLayout.groups[t],o=a.startAngle*J.DEGREES+n,l=a.endAngle*J.DEGREES+n;r.setAll({radius:e,innerRadius:e-i,startAngle:o,arc:l-o});const u=s.get("label");u.setAll({labelAngle:o+(l-o)/2}),u.setPrivate("radius",e),u.setPrivate("innerRadius",.1),t++}));const s=e-this.get("nodeWidth",0);l.each(this._chordLayout,(e=>{let t=this._linksByIndex[e.source.index+"_"+e.target.index];if(t||(t=this._linksByIndex[e.target.index+"_"+e.source.index]),t){const n=t.get("link");this._getLinkPoints(n,s,e),this._updateLink(this._ribbon,n,s,e)}}))}}_getLinkPoints(e,t,n){const i=n.source,s=n.target,r=this.get("startAngle",0)*J.RADIANS;if(i&&s){const n=i.startAngle,a=n+(i.endAngle-n)/2+r,o=s.startAngle,l=o+(s.endAngle-o)/2+r;e._p0={x:t*Math.cos(a),y:t*Math.sin(a)},e._p1={x:t*Math.cos(l),y:t*Math.sin(l)}}}_updateLink(e,t,n,i){i&&(e.sourceRadius(se.relativeToValue(t.get("sourceRadius",r.AQ),n)),e.targetRadius(se.relativeToValue(t.get("targetRadius",r.AQ),n)),t.set("draw",(t=>{e.context(t),e(i)})))}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("label");t&&t.dispose()}}Object.defineProperty(re,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chord"}),Object.defineProperty(re,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:f.classNames.concat([re.className])});class ae extends ie{_afterNew(){this._settings.themeTags=se.mergeTags(this._settings.themeTags,["chord","link","directed"]),super._afterNew()}}Object.defineProperty(ae,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLinkDirected"}),Object.defineProperty(ae,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ie.classNames.concat([ae.className])});class oe extends re{constructor(){super(...arguments),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:N(!0,!1)}),Object.defineProperty(this,"_ribbonArrow",{enumerable:!0,configurable:!0,writable:!0,value:F()}),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>ae._new(this._root,{themeTags:["link","shape"]},[this.links.template])))})}makeLink(e){const t=this.linksContainer.children.push(this.links.make());return t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_afterNew(){this._settings.themeTags=se.mergeTags(this._settings.themeTags,["directed"]),super._afterNew(),this._markDirtyKey("linkHeadRadius")}_prepareChildren(){const e="linkHeadRadius";if(this.isDirty(e)){const t=this.get(e);if(null==t)this._ribbon=M();else{let e=F();e.headRadius(t),this._ribbon=e}}super._prepareChildren()}}Object.defineProperty(oe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordDirected"}),Object.defineProperty(oe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:re.classNames.concat([oe.className])});class le extends re{_afterNew(){this._settings.themeTags=se.mergeTags(this._settings.themeTags,["chord","basic"]),super._afterNew()}_makeMatrix(){const e=[];return l.each(this.nodes.dataItems,(t=>{const n=[];e.push(n),l.each(this.nodes.dataItems,(e=>{let i=1;t===e&&(i=0),n.push(i)}))})),e}_updateLink(e,t,n,i){if(t._type=this.get("linkType"),i){const e=this.get("linkType");t.set("draw",(n=>{let i=t._p0,s=t._p1;i&&s&&(n.moveTo(i.x,i.y),"line"==e?n.lineTo(s.x,s.y):n.quadraticCurveTo(0,0,s.x,s.y))}))}}_getLinkPoints(e,t,n){const i=e.get("source"),s=e.get("target");if(i&&s){const n=i.get("slice"),r=s.get("slice"),a=n.get("startAngle",0)+n.get("arc",0)/2,o=r.get("startAngle",0)+r.get("arc",0)/2;e._p0={x:t*J.cos(a),y:t*J.sin(a)},e._p1={x:t*J.cos(o),y:t*J.sin(o)}}}}Object.defineProperty(le,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNonRibbon"}),Object.defineProperty(le,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:re.classNames.concat([le.className])});var ue=n(3497);class ce extends ${constructor(){super(...arguments),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>ue.c._new(this._root,{themeTags:["shape"]},[this.rectangles.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeNode(e){const t=this.flow,n=super.makeNode(e,"sankey"),i=n.children.insertIndex(0,this.rectangles.make());this.rectangles.push(i),i._setSoft("fill",e.get("fill")),e.set("rectangle",i),n.events.on("dragged",(()=>{const e=n.dataItem.get("d3SankeyNode");e&&t&&("horizontal"==t.get("orientation")?(e.x0=n.x(),e.y0=n.y()):(e.x0=n.y(),e.y0=n.x()),t.updateSankey())}));const s=this.labels.make();return this.labels.push(s),t&&s.addTag(t.get("orientation","")),n.children.push(s),e.set("label",s),s._setDataItem(e),i._setDataItem(e),n}_positionBullet(e){const t=e.get("sprite");if(t){const n=t.dataItem;if(n){const t=e.get("sprite");if(t){const i=n.get("rectangle"),s=n.get("node"),r=e.get("locationX",.5),a=e.get("locationY",.5);i&&t.setAll({x:s.x()+i.width()*r,y:s.y()+i.height()*a})}}}}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("rectangle");t&&(this.rectangles.removeValue(t),t.dispose())}}Object.defineProperty(ce,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyNodes"}),Object.defineProperty(ce,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:$.classNames.concat([ce.className])});class he extends ne{constructor(){super(...arguments),Object.defineProperty(this,"_svgPath",{enumerable:!0,configurable:!0,writable:!0,value:document.createElementNS("http://www.w3.org/2000/svg","path")}),Object.defineProperty(this,"_totalLength",{enumerable:!0,configurable:!0,writable:!0,value:0})}_beforeChanged(){if(super._beforeChanged(),this.isDirty("source")){const e=this.get("source");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this.markDirty()})))}}if(this.isDirty("target")){const e=this.get("target");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this.markDirty()})))}}if(this.isPrivateDirty("orientation")){const e=this.series,t=this.dataItem;t&&e&&e._updateLinkColor(t)}const e=this.get("target"),t=this.get("source");let n,i;if(t&&e){this._clear=!0,n=t.get("node"),i=e.get("node");let s=0,r=0,a=0,o=0,l=0,u=0,c=0,h=0,d=0,g=0,f=0,p=0,b=0,m=0,y=0,k=0,w=0,v=0;const _=this.dataItem;if(_){const x=_.get("d3SankeyLink");if(x){let _=x.width||0,A=this.getPrivate("orientation");"vertical"==A?(n&&(a=n.y()),i&&(o=i.y()),w=90,v=90,s=x.y0||0,r=x.y1||0,o<a&&([s,r]=[r,s],[a,o]=[o,a]),t.get("unknown")&&(s=r,a+=(o-a)/2),e.get("unknown")&&(r=s,o=a+(o-a)/2),l=s-_/2,u=a,c=r-_/2,h=o,d=s+_/2,g=r+_/2,f=a,p=o,b=s,m=r,y=a,k=o):(n&&(s=n.x()),i&&(r=i.x()),a=x.y0||0,o=x.y1||0,r<s&&([s,r]=[r,s],[a,o]=[o,a]),t.get("unknown")&&(a=o,s+=(r-s)/2),e.get("unknown")&&(o=a,r=s+(r-s)/2),l=s,u=a-_/2,c=r,h=o-_/2,d=s,g=r,f=a+_/2,p=o+_/2,b=s,m=r,y=a,k=o),J.round(l,3)==J.round(c,3)&&(c+=.01),J.round(u,3)==J.round(h,3)&&(h+=.01),J.round(d,3)==J.round(g,3)&&(g+=.01),J.round(f,3)==J.round(p,3)&&(p+=.01);let N=this.get("controlPointDistance",.2);N=Math.min(.4999,N);let L=l+(c-l)*N*J.cos(w),P=u+(h-u)*N*J.sin(w),I=c-(c-l)*N*J.cos(v),D=h-(h-u)*N*J.sin(v),O=b+(m-b)*N*J.cos(w),T=y+(k-y)*N*J.sin(w),j=m-(m-b)*N*J.cos(v),S=k-(k-y)*N*J.sin(v),C=J.getAngle({x:L,y:P},{x:I,y:D}),R=(_/J.cos(C)-_)/J.tan(C)*J.cos(w),G=(_/J.sin(C)-_)*J.tan(C)*J.sin(w),M=-R/2+d+(g-d)*N*J.cos(w),F=-G/2+f+(p-f)*N*J.sin(w),W=-R/2+g-(g-d)*N*J.cos(v),B=-G/2+p-(p-f)*N*J.sin(v);L+=R/2,P+=G/2,I+=R/2,D+=G/2,"vertical"==A?(P=Math.min(h,Math.max(u+1,P)),F=Math.min(p,Math.max(f+1,F)),D=Math.max(u,Math.min(h-1,D)),B=Math.max(f,Math.min(p-1,B))):(L=Math.min(c,Math.max(l+1,L)),M=Math.min(g,Math.max(d+1,M)),I=Math.max(l,Math.min(c-1,I)),W=Math.max(d,Math.min(g-1,W)));let Y=[[l,u,d,f],[L,P,M,F],[I,D,W,B],[c,h,g,p]];this.set("draw",(e=>{const t=this.series;t._fillGenerator.context(e),t._fillGenerator(Y)}));let E=[[b,y],[O,T],[j,S],[m,k]];const z=this.series._strokeGenerator(E);z&&(this._svgPath.setAttribute("d",z),this._totalLength=this._svgPath.getTotalLength())}}}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem)}getPoint(e){if(this._svgPath&&this._svgPath.getAttribute("d")){let t=this._svgPath.getPointAtLength(e*this._totalLength-.1),n=this._svgPath.getPointAtLength(e*this._totalLength+.1),i=this.toGlobal(this._svgPath.getPointAtLength(e*this._totalLength));return{x:i.x,y:i.y,angle:J.getAngle(t,n)}}return{x:0,y:0,angle:0}}_getTooltipPoint(){return this.toLocal(super._getTooltipPoint())}}Object.defineProperty(he,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyLink"}),Object.defineProperty(he,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ne.classNames.concat([he.className])});var de=n(3794),ge=n(774),fe=n(8289),pe=n(5892);function be(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let i=-1;for(let s of e)(s=+t(s,++i,e))&&(n+=s)}return n}function me(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let s of e)null!=(s=t(s,++i,e))&&(n<s||void 0===n&&s>=s)&&(n=s)}return n}function ye(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let s of e)null!=(s=t(s,++i,e))&&(n>s||void 0===n&&s>=s)&&(n=s)}return n}function ke(e){return e.target.depth}function we(e){return e.depth}function ve(e,t){return t-1-e.height}function _e(e,t){return e.sourceLinks.length?e.depth:t-1}function xe(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?ye(e.sourceLinks,ke)-1:0}function Ae(e){return function(){return e}}function Ne(e,t){return Pe(e.source,t.source)||e.index-t.index}function Le(e,t){return Pe(e.target,t.target)||e.index-t.index}function Pe(e,t){return e.y0-t.y0}function Ie(e){return e.value}function De(e){return e.index}function Oe(e){return e.nodes}function Te(e){return e.links}function je(e,t){const n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function Se({nodes:e}){for(const t of e){let e=t.y0,n=e;for(const n of t.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(const e of t.targetLinks)e.y1=n+e.width/2,n+=e.width}}function Ce(){let e,t,n,i=0,s=0,r=1,a=1,o=24,l=8,u=De,c=_e,h=Oe,d=Te,g=6;function f(){const e={nodes:h.apply(null,arguments),links:d.apply(null,arguments)};return p(e),b(e),m(e),y(e),k(e),Se(e),e}function p({nodes:e,links:t}){for(const[t,n]of e.entries())n.index=t,n.sourceLinks=[],n.targetLinks=[];const i=new Map(e.map(((t,n)=>[u(t,n,e),t])));for(const[e,n]of t.entries()){n.index=e;let{source:t,target:s}=n;"object"!=typeof t&&(t=n.source=je(i,t)),"object"!=typeof s&&(s=n.target=je(i,s)),t.sourceLinks.push(n),s.targetLinks.push(n)}if(null!=n)for(const{sourceLinks:t,targetLinks:i}of e)t.sort(n),i.sort(n)}function b({nodes:e}){for(const t of e)t.value=void 0===t.fixedValue?Math.max(be(t.sourceLinks,Ie),be(t.targetLinks,Ie)):t.fixedValue}function m({nodes:e}){const t=e.length;let n=new Set(e),i=new Set,s=0;for(;n.size;){for(const e of n){e.depth=s;for(const{target:t}of e.sourceLinks)i.add(t)}if(++s>t)throw new Error("circular link");n=i,i=new Set}}function y({nodes:e}){const t=e.length;let n=new Set(e),i=new Set,s=0;for(;n.size;){for(const e of n){e.height=s;for(const{source:t}of e.targetLinks)i.add(t)}if(++s>t)throw new Error("circular link");n=i,i=new Set}}function k(n){const u=function({nodes:e}){const n=me(e,(e=>e.depth))+1,s=(r-i-o)/(n-1),a=new Array(n);for(const t of e){const e=Math.max(0,Math.min(n-1,Math.floor(c.call(null,t,n))));t.layer=e,t.x0=i+e*s,t.x1=t.x0+o,a[e]?a[e].push(t):a[e]=[t]}if(t)for(const e of a)e.sort(t);return a}(n);e=Math.min(l,(a-s)/(me(u,(e=>e.length))-1)),function(t){const n=ye(t,(t=>(a-s-(t.length-1)*e)/be(t,Ie)));for(const i of t){let t=s;for(const s of i){s.y0=t,s.y1=t+s.value*n,t=s.y1+e;for(const e of s.sourceLinks)e.width=e.value*n}t=(a-t+e)/(i.length+1);for(let e=0;e<i.length;++e){const n=i[e];n.y0+=t*(e+1),n.y1+=t*(e+1)}L(i)}}(u);for(let e=0;e<g;++e){const t=Math.pow(.99,e),n=Math.max(1-t,(e+1)/g);v(u,t,n),w(u,t,n)}}function w(e,n,i){for(let s=1,r=e.length;s<r;++s){const r=e[s];for(const e of r){let t=0,i=0;for(const{source:n,value:s}of e.targetLinks){let r=s*(e.layer-n.layer);t+=P(n,e)*r,i+=r}if(!(i>0))continue;let s=(t/i-e.y0)*n;e.y0+=s,e.y1+=s,N(e)}void 0===t&&r.sort(Pe),_(r,i)}}function v(e,n,i){for(let s=e.length-2;s>=0;--s){const r=e[s];for(const e of r){let t=0,i=0;for(const{target:n,value:s}of e.sourceLinks){let r=s*(n.layer-e.layer);t+=I(e,n)*r,i+=r}if(!(i>0))continue;let s=(t/i-e.y0)*n;e.y0+=s,e.y1+=s,N(e)}void 0===t&&r.sort(Pe),_(r,i)}}function _(t,n){const i=t.length>>1,r=t[i];A(t,r.y0-e,i-1,n),x(t,r.y1+e,i+1,n),A(t,a,t.length-1,n),x(t,s,0,n)}function x(t,n,i,s){for(;i<t.length;++i){const r=t[i],a=(n-r.y0)*s;a>1e-6&&(r.y0+=a,r.y1+=a),n=r.y1+e}}function A(t,n,i,s){for(;i>=0;--i){const r=t[i],a=(r.y1-n)*s;a>1e-6&&(r.y0-=a,r.y1-=a),n=r.y0-e}}function N({sourceLinks:e,targetLinks:t}){if(void 0===n){for(const{source:{sourceLinks:e}}of t)e.sort(Le);for(const{target:{targetLinks:t}}of e)t.sort(Ne)}}function L(e){if(void 0===n)for(const{sourceLinks:t,targetLinks:n}of e)t.sort(Le),n.sort(Ne)}function P(t,n){let i=t.y0-(t.sourceLinks.length-1)*e/2;for(const{target:s,width:r}of t.sourceLinks){if(s===n)break;i+=r+e}for(const{source:e,width:s}of n.targetLinks){if(e===t)break;i-=s}return i}function I(t,n){let i=n.y0-(n.targetLinks.length-1)*e/2;for(const{source:s,width:r}of n.targetLinks){if(s===t)break;i+=r+e}for(const{target:e,width:s}of t.sourceLinks){if(e===n)break;i-=s}return i}return f.update=function(e){return Se(e),e},f.nodeId=function(e){return arguments.length?(u="function"==typeof e?e:Ae(e),f):u},f.nodeAlign=function(e){return arguments.length?(c="function"==typeof e?e:Ae(e),f):c},f.nodeSort=function(e){return arguments.length?(t=e,f):t},f.nodeWidth=function(e){return arguments.length?(o=+e,f):o},f.nodePadding=function(t){return arguments.length?(l=e=+t,f):l},f.nodes=function(e){return arguments.length?(h="function"==typeof e?e:Ae(e),f):h},f.links=function(e){return arguments.length?(d="function"==typeof e?e:Ae(e),f):d},f.linkSort=function(e){return arguments.length?(n=e,f):n},f.size=function(e){return arguments.length?(i=s=0,r=+e[0],a=+e[1],f):[r-i,a-s]},f.extent=function(e){return arguments.length?(i=+e[0][0],r=+e[1][0],s=+e[0][1],a=+e[1][1],f):[[i,s],[r,a]]},f.iterations=function(e){return arguments.length?(g=+e,f):g},f}class Re extends f{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new H.o(X.YS.new({}),(()=>he._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ce.new(this._root,{}))}),Object.defineProperty(this,"_d3Sankey",{enumerable:!0,configurable:!0,writable:!0,value:Ce()}),Object.defineProperty(this,"_d3Graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,de.Z)()}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,ge.Z)()})}_afterNew(){this._settings.themeTags=se.mergeTags(this._settings.themeTags,["sankey",this._settings.orientation||"horizontal"]),this._fillGenerator.y0((function(e){return e[3]})),this._fillGenerator.x0((function(e){return e[2]})),this._fillGenerator.y1((function(e){return e[1]})),this._fillGenerator.x1((function(e){return e[0]})),super._afterNew()}makeLink(e){const t=e.get("source"),n=e.get("target"),i=this.links.make();return t.get("unknown")&&(i.addTag("source"),i.addTag("unknown")),n.get("unknown")&&(i.addTag("target"),i.addTag("unknown")),this.linksContainer.children.push(i),i._setDataItem(e),i.set("source",t),i.set("target",n),i.series=this,this.links.push(i),i}updateSankey(){const e=this._d3Graph;e&&(this._d3Sankey.update(e),l.each(this.dataItems,(e=>{const t=e.get("link");t.setPrivate("orientation",this.get("orientation")),t.markDirty()})))}_updateLinkColor(e){super._updateLinkColor(e);const t=this.get("orientation"),n=e.get("link")._fillGradient,i=e.get("link")._strokeGradient;"vertical"==t?(n&&n.set("rotation",90),i&&i.set("rotation",90)):(n&&n.set("rotation",0),i&&i.set("rotation",0))}_getBulletLocation(e){return"vertical"==this.get("orientation")?e.get("locationY",0):e.get("locationX",0)}_prepareChildren(){super._prepareChildren();let e=!1;if("vertical"==this.get("orientation")&&(e=!0),this.isDirty("orientation")||this.isDirty("linkTension")){const t=this.get("linkTension",.5);e?(this._fillGenerator.curve((0,pe.$)(t)),this._strokeGenerator.curve((0,pe.$)(t))):(this._fillGenerator.curve((0,fe.G)(t)),this._strokeGenerator.curve((0,fe.G)(t)))}if((this._valuesDirty||this._sizeDirty||this.isDirty("nodePadding")||this.isDirty("nodeWidth")||this.isDirty("nodeAlign")||this.isDirty("nodeSort")||this.isDirty("orientation")||this.isDirty("linkTension"))&&this._nodesData.length>0){const t=this._d3Sankey;let n=this.innerWidth(),i=this.innerHeight();switch(e&&([n,i]=[i,n]),t.size([n,i]),t.nodePadding(this.get("nodePadding",10)),t.nodeWidth(this.get("nodeWidth",10)),t.nodeSort(this.get("nodeSort",null)),this.get("nodeAlign")){case"right":t.nodeAlign(ve);break;case"justify":t.nodeAlign(_e);break;case"center":t.nodeAlign(xe);break;default:t.nodeAlign(we)}this._d3Graph=t({nodes:this._nodesData,links:this._linksData}),l.each(this.dataItems,(e=>{const t=e.get("link");t.setPrivate("orientation",this.get("orientation")),t.markDirty()}));const s=this._d3Graph;if(s){const t=s.nodes;l.each(t,(t=>{const n=t.dataItem,i=n.get("node");let s,r,a,o;e?(s=t.y0,r=t.y1,a=t.x0,o=t.x1):(s=t.x0,r=t.x1,a=t.y0,o=t.y1),g.isNumber(s)&&g.isNumber(r)&&g.isNumber(a)&&g.isNumber(o)&&(i.setAll({x:s,y:a,width:r-s,height:o-a}),n.get("rectangle").setAll({width:r-s,height:o-a}))}))}}}}Object.defineProperty(Re,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sankey"}),Object.defineProperty(Re,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:f.classNames.concat([Re.className])})},906:function(e,t,n){n.r(t),n.d(t,{am5flow:function(){return i}});const i=n(7984)}},function(e){var t=(906,e(e.s=906)),n=window;for(var i in t)n[i]=t[i];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})}]);